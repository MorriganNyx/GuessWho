<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap"
        rel="stylesheet">

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=search" />

    <link rel="stylesheet" href="search.css">
    <link rel="stylesheet" href="sandbox.js">

    <title>GuessWho</title>
</head>

<body>
    <header>
        <div class="logo">
            <img src="/image/Logo.png" alt="">
        </div>
        <div class="navbar">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="search.html">Search</a></li>
                <li><a href="students.html">Students</a></li>
            </ul>
        </div>
    </header>
    <main>
        <div class="main">
            <div class="searchBar">
                <input type="text" id="searchInput" placeholder="Search Student">
                <button onclick="searchStudent()"><span class="material-symbols-outlined">
                        search
                    </span></button>
            </div>

            <div class="grid" id="studentGrid"></div>
            <p id="noStudent" style="display:none; text-align:center; margin-top:2%; font-size:1.5%;">No student found
            </p>

        </div>
    </main>
    <footer></footer>

    <script>
        let students = [];

        fetch('https://guesswho-1c5f6-default-rtdb.asia-southeast1.firebasedatabase.app/')
            .then(response => response.json())
            .then(data => {
                students = data;       
                displayStudents(students); 
            })
            .catch(error => console.error("Error:", error));

        document.getElementById("searchInput").addEventListener("input", searchStudent);

        function searchStudent() {
            const query = document.getElementById("searchInput").value.toLowerCase().trim();
            const filtered = students.filter(student => student.name.toLowerCase().includes(query));
            displayStudents(filtered);
        }

        function displayStudents(list) {
            const grid = document.getElementById("studentGrid");
            grid.innerHTML = ""; 

            if (list.length === 0) {
                document.getElementById("noStudent").style.display = "block";
                return;
            } else {
                document.getElementById("noStudent").style.display = "none";
            }

            shuffle(list).forEach(student => {
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `
                <img src="${student.photo}" alt="${student.name}">
                <p class="name">${student.name}</p>
    `;
                grid.appendChild(card);
            });
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

    </script>
</body>

</html>